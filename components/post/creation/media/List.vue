<script setup lang="ts">
	defineProps<{
		items: Array<{ file: File; source: string }>;
	}>();

	defineEmits<{
		(e: 'deleteMedia', index: number): void;
	}>();
</script>

<template>
	<PostCreationMediaItem
		v-if="items.length === 1"
		:source="items[0].source"
		@on-delete="$emit('deleteMedia', 0)"
	/>
	<div
		v-else-if="items.length === 2"
		class="grid w-full grid-cols-2 gap-x-1"
	>
		<PostCreationMediaItem
			:source="items[0].source"
			@on-delete="$emit('deleteMedia', 0)"
		/>
		<PostCreationMediaItem
			:source="items[1].source"
			@on-delete="$emit('deleteMedia', 1)"
		/>
	</div>
	<!--	FIXME: slight move on transition from div to Carousel -->
	<!--	FIXME: Carousel component is broken in primevue-tailwind: -->
	<!--	https://github.com/primefaces/primevue-tailwind/issues/177 -->
	<!--	https://github.com/primefaces/primevue-tailwind/issues/256 -->
	<Carousel
		v-else-if="items.length > 2"
		container-class="!relative"
		:value="items"
		:num-visible="2"
		:num-scroll="1"
		:show-indicators="false"
		:prev-button-props="{ class: '!absolute z-[1] left-2 !size-9', rounded: true, severity: 'contrast' }"
		:next-button-props="{ class: '!absolute z-[1] right-2 !size-9', rounded: true, severity: 'contrast' }"
		:unstyled="false"
	>
		<template #item="item">
			<div class="size-full px-0.5">
				<PostCreationMediaItem
					:source="item.data.source"
					@on-delete="$emit('deleteMedia', item.index)"
				/>
			</div>
		</template>
	</Carousel>
</template>
